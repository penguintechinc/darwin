# Production environment overrides
replicaCount: 2

image:
  tag: "7-alpine"

persistence:
  enabled: true
  size: 20Gi
  storageClassName: "fast"

resources:
  limits:
    cpu: 500m
    memory: 1Gi
  requests:
    cpu: 250m
    memory: 512Mi

redis:
  requirepass: true
  appendonly: true
  appendfsync: everysec

nodeSelector:
  workload-type: cache

affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
            - key: app.kubernetes.io/name
              operator: In
              values:
                - redis
        topologyKey: kubernetes.io/hostname

tolerations:
  - key: cache-workload
    operator: Equal
    value: "true"
    effect: NoSchedule

livenessProbe:
  exec:
    command:
      - redis-cli
      - "-a"
      - "$(REDIS_PASSWORD)"
      - "ping"
  initialDelaySeconds: 60
  periodSeconds: 15
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  exec:
    command:
      - redis-cli
      - "-a"
      - "$(REDIS_PASSWORD)"
      - "ping"
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 3
  failureThreshold: 2

secrets:
  redisPassword: "changeme-in-production"
